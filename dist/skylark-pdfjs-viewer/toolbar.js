/**
 * skylark-pdfjs-viewer - A version of video.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./pdfjs_dev","./ui_utils"],function(e,t){const{animationStarted:a,DEFAULT_SCALE:s,DEFAULT_SCALE_VALUE:n,MAX_SCALE:i,MIN_SCALE:o,noContextMenuHandler:l,NullL10n:u}=t,c="visiblePageIsLoading",p=140,g=162;return{Toolbar:class{constructor(e,t,a=u){this.toolbar=e.container,this.eventBus=t,this.l10n=a,this.buttons=[{element:e.previous,eventName:"previouspage"},{element:e.next,eventName:"nextpage"},{element:e.zoomIn,eventName:"zoomin"},{element:e.zoomOut,eventName:"zoomout"},{element:e.openFile,eventName:"openfile"},{element:e.print,eventName:"print"},{element:e.presentationModeButton,eventName:"presentationmode"},{element:e.download,eventName:"download"},{element:e.viewBookmark,eventName:null}],this.items={numPages:e.numPages,pageNumber:e.pageNumber,scaleSelectContainer:e.scaleSelectContainer,scaleSelect:e.scaleSelect,customScaleOption:e.customScaleOption,previous:e.previous,next:e.next,zoomIn:e.zoomIn,zoomOut:e.zoomOut},this._wasLocalized=!1,this.reset(),this._bindListeners()}setPageNumber(e,t){this.pageNumber=e,this.pageLabel=t,this._updateUIState(!1)}setPagesCount(e,t){this.pagesCount=e,this.hasPageLabels=t,this._updateUIState(!0)}setPageScale(e,t){this.pageScaleValue=(e||t).toString(),this.pageScale=t,this._updateUIState(!1)}reset(){this.pageNumber=0,this.pageLabel=null,this.hasPageLabels=!1,this.pagesCount=0,this.pageScaleValue=n,this.pageScale=s,this._updateUIState(!0),this.updateLoadingIndicatorState()}_bindListeners(){const{pageNumber:e,scaleSelect:t}=this.items,a=this;for(const{element:e,eventName:t}of this.buttons)e.addEventListener("click",e=>{null!==t&&this.eventBus.dispatch(t,{source:this})});e.addEventListener("click",function(){this.select()}),e.addEventListener("change",function(){a.eventBus.dispatch("pagenumberchanged",{source:a,value:this.value})}),t.addEventListener("change",function(){"custom"!==this.value&&a.eventBus.dispatch("scalechanged",{source:a,value:this.value})}),t.oncontextmenu=l,this.eventBus._on("localized",()=>{this._wasLocalized=!0,this._adjustScaleWidth(),this._updateUIState(!0)})}_updateUIState(e=!1){if(!this._wasLocalized)return;const{pageNumber:t,pagesCount:a,pageScaleValue:s,pageScale:n,items:l}=this;e&&(this.hasPageLabels?l.pageNumber.type="text":(l.pageNumber.type="number",this.l10n.get("of_pages",{pagesCount:a},"of {{pagesCount}}").then(e=>{l.numPages.textContent=e})),l.pageNumber.max=a),this.hasPageLabels?(l.pageNumber.value=this.pageLabel,this.l10n.get("page_of_pages",{pageNumber:t,pagesCount:a},"({{pageNumber}} of {{pagesCount}})").then(e=>{l.numPages.textContent=e})):l.pageNumber.value=t,l.previous.disabled=t<=1,l.next.disabled=t>=a,l.zoomOut.disabled=n<=o,l.zoomIn.disabled=n>=i;const u=Math.round(1e4*n)/100;this.l10n.get("page_scale_percent",{scale:u},"{{scale}}%").then(e=>{let t=!1;for(const e of l.scaleSelect.options)e.value===s?(e.selected=!0,t=!0):e.selected=!1;t||(l.customScaleOption.textContent=e,l.customScaleOption.selected=!0)})}updateLoadingIndicatorState(e=!1){this.items.pageNumber.classList.toggle(c,e)}async _adjustScaleWidth(){const{items:t,l10n:s}=this,n=Promise.all([s.get("page_scale_auto",null,"Automatic Zoom"),s.get("page_scale_actual",null,"Actual Size"),s.get("page_scale_fit",null,"Page Fit"),s.get("page_scale_width",null,"Page Width")]);let i=document.createElement("canvas");(void 0===e||e.test("MOZCENTRAL || GENERIC"))&&(i.mozOpaque=!0);let o=i.getContext("2d",{alpha:!1});await a;const{fontSize:l,fontFamily:u}=getComputedStyle(t.scaleSelect);o.font=`${l} ${u}`;let c=0;for(const e of await n){const{width:t}=o.measureText(e);t>c&&(c=t)}const m=g-p;(c+=2*m)>p&&(t.scaleSelect.style.width=`${c+m}px`,t.scaleSelectContainer.style.width=`${c}px`),i.width=0,i.height=0,i=o=null}}}});
//# sourceMappingURL=sourcemaps/toolbar.js.map
