{"version":3,"sources":["pdf_viewer.js"],"names":["define","pdfjsLib","ui_utils","base_viewer","ScrollMode","SpreadMode","BaseViewer","shadow","PDFViewer","_viewerElement","this","viewer","[object Object]","pageDiv","pageSpot","pageNumber","isInPresentationMode","left","offsetLeft","clientLeft","right","clientWidth","scrollLeft","container","_isScrollModeHorizontal","top","super","_scrollIntoView","_getCurrentVisiblePage","_getVisiblePages","visiblePages","currentId","_currentPageNumber","stillFullyVisible","page","percent","id","_scrollMode","VERTICAL","_spreadMode","NONE","_setCurrentPageNumber"],"mappings":";;;;;;;AAAAA,QACE,wBACA,aACA,iBACA,SAASC,EAASC,EAASC,GAgB3B,MAAMC,WAAEA,EAAUC,WAAEA,GAAeH,GAC7BI,WAAEA,GAAeH,GACjBI,OAAEA,GAAWN,EA2DnB,OAASO,wBAzDeF,EACtBG,qBACE,OAAOF,EAAOG,KAAM,iBAAkBA,KAAKC,QAG7CC,iBAAgBC,QAAEA,EAAOC,SAAEA,EAAW,KAAIC,WAAEA,EAAa,OACvD,IAAKD,IAAaJ,KAAKM,qBAAsB,CAC3C,MAAMC,EAAOJ,EAAQK,WAAaL,EAAQM,WACpCC,EAAQH,EAAOJ,EAAQQ,aACvBC,WAAEA,EAAUD,YAAEA,GAAgBX,KAAKa,WAEvCb,KAAKc,yBACLP,EAAOK,GACPF,EAAQE,EAAaD,KAErBP,GAAaG,KAAM,EAAGQ,IAAK,IAG/BC,MAAMC,iBAAkBd,QAAAA,EAASC,SAAAA,EAAUC,WAAAA,IAG7CH,mBACE,OAAIF,KAAKM,qBAGAN,KAAKkB,yBAEPF,MAAMG,mBAGfjB,cAAckB,GACZ,GAAIpB,KAAKM,qBACP,OAEF,IAAIe,EAAYrB,KAAKsB,mBACjBC,GAAoB,EAExB,IAAK,MAAMC,KAAQJ,EAAc,CAC/B,GAAII,EAAKC,QAAU,IACjB,MAEF,GACED,EAAKE,KAAOL,GACZrB,KAAK2B,cAAgBjC,EAAWkC,UAChC5B,KAAK6B,cAAgBlC,EAAWmC,KAChC,CACAP,GAAoB,EACpB,OAGCA,IACHF,EAAYD,EAAa,GAAGM,IAE9B1B,KAAK+B,sBAAsBV","file":"../pdf_viewer.js","sourcesContent":["define([\n  \"skylark-pdfjs-display\",\n  \"./ui_utils\",\n  \"./base_viewer\"\n],function(pdfjsLib,ui_utils,base_viewer){\n  /* Copyright 2014 Mozilla Foundation\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *     http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  const { ScrollMode, SpreadMode } = ui_utils;\n  const { BaseViewer } = base_viewer;\n  const { shadow } = pdfjsLib;\n\n  class PDFViewer extends BaseViewer {\n    get _viewerElement() {\n      return shadow(this, \"_viewerElement\", this.viewer);\n    }\n\n    _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null }) {\n      if (!pageSpot && !this.isInPresentationMode) {\n        const left = pageDiv.offsetLeft + pageDiv.clientLeft;\n        const right = left + pageDiv.clientWidth;\n        const { scrollLeft, clientWidth } = this.container;\n        if (\n          this._isScrollModeHorizontal ||\n          left < scrollLeft ||\n          right > scrollLeft + clientWidth\n        ) {\n          pageSpot = { left: 0, top: 0 };\n        }\n      }\n      super._scrollIntoView({ pageDiv, pageSpot, pageNumber });\n    }\n\n    _getVisiblePages() {\n      if (this.isInPresentationMode) {\n        // The algorithm in `getVisibleElements` doesn't work in all browsers and\n        // configurations (e.g. Chrome) when Presentation Mode is active.\n        return this._getCurrentVisiblePage();\n      }\n      return super._getVisiblePages();\n    }\n\n    _updateHelper(visiblePages) {\n      if (this.isInPresentationMode) {\n        return;\n      }\n      let currentId = this._currentPageNumber;\n      let stillFullyVisible = false;\n\n      for (const page of visiblePages) {\n        if (page.percent < 100) {\n          break;\n        }\n        if (\n          page.id === currentId &&\n          this._scrollMode === ScrollMode.VERTICAL &&\n          this._spreadMode === SpreadMode.NONE\n        ) {\n          stillFullyVisible = true;\n          break;\n        }\n      }\n      if (!stillFullyVisible) {\n        currentId = visiblePages[0].id;\n      }\n      this._setCurrentPageNumber(currentId);\n    }\n  }\n\n  return { PDFViewer };\n});"]}